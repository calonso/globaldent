<?php
/**
* Esta clase se encarga de gestionar los parmetros que se reciben. 
* Los parmetros se reciben de la forma: /variable.valor, esta clase permite 
* recojer los parmetros.
* Este sistema de formateo de parmetros permite una indexacin perfecta, de las pginas,
* en los buscadores tipo google.
*/
class Params {
		
	var $HTTP_GET_PARSED_VARS;
	
	/**
	* Mtodo constructor de la clase. Simplemente recoje todos los parmetros
	* recibidos.
	*/
	function Params () {
		
		// Parseo de parmetros get
		if(!empty($_SERVER["PATH_INFO"])) {	

			$fchx_lang=$_SERVER["PATH_INFO"];
  			$fchx_tmp = ereg_replace("^/","",$fchx_lang);
			$fchx_tok = strtok($fchx_tmp,"/");
			while($fchx_tok) {
    		// list($k,$v) = explode(".",$fchx_tok);
				$fchx_pos = strpos ($fchx_tok, ".");
				if ($fchx_pos === false) {
					$k = $fchx_tok;
					$v = "";
				} else {
					$k = substr($fchx_tok,0,$fchx_pos);
					$v = urldecode(substr($fchx_tok,$fchx_pos+1));
				}
			$this->HTTP_GET_PARSED_VARS[$k] = $v;
			$fchx_tok = strtok("/");
			}
		}
	}
	
	/**
	* Mtodo que permite recojer parmetros.
	* Recibe como parmetros de entrada: el nombre de la variable, parmetro, a recojer
	* y si el valor del parmetro contiene caracteres especiales que deben convertirse a caracteres html.
	* Devuelve el valor del parmetro solicitado. 
	*
	* @param string, boolean
	* @return string
	*/
	function getParam($param, $htmlencode=false) {

	  if ($htmlencode) {
	    if ($this->HTTP_GET_PARSED_VARS[$param]) {
	      return htmlspecialchars(stripslashes($this->HTTP_GET_PARSED_VARS[$param]));
	    } else {
	      return htmlspecialchars(stripslashes($_REQUEST[$param]));
	    }
	  } else { 
	    if ($this->HTTP_GET_PARSED_VARS[$param]) {
	      return stripslashes($this->HTTP_GET_PARSED_VARS[$param]);		
	    } else {
	      return $_REQUEST[$param];
	  	}
	  }
	  
	  					
    }
	
	
	function getParams() {
		return $this->HTTP_GET_PARSED_VARS;
	}
	
	
}

?>